# Node.js 地下铁沙龙 - 2016-12-03 · 广州站

主题：八面玲珑的 Node.js

地点：在UC总部？UC 正常上班。广电平云广场 B 塔 15 楼

时间：14：00

## 一、【UC】（wechat: 366348）： Thrift 介绍 （迟到了，没看到介绍）

### 介绍UC中间件
- 移动2G时代，服务器做中转，省流加速。
- 十年历史
- ...

### 突破旧系统特供性
- 旧系统改造基础服务，供其它服务使用

### Thrift
- 历史：2007, Facebook, 2014 Node.js
- 使用场景：运算部分用其它服务，使 thrift 通信
- 特别提到：爬虫系统：hydra 转码。。。？（没多介绍），性能好。
- 代码演示：1.自动生成接口代码


### Q&A （获得一本 Node.js 入门书）

- 稳定性：thrift 服务的稳定性？
- 监控：失败统计，重试机制。（手写统计）
- 分布式：1对1，1 对 n， n 对 n, 多服务之间的资源调度？（回答了 1 对 n, 其它听不清。- 跟同事讨论下，好像也太不对，应该是 1 对 1 吧，分布式无从谈起。。。）


## 二、【淘宝】九十: Node.js 服务前端数据接口的演进

### 多终端挑战
- 桌面 Web 时代
- 业务逻辑，
- 多端时代的开始
- BFF: back for frontend 后端服务前端
- hsf：阿里其中一个底层框架， node.js 调用。序列化 hessian 。。。听不懂

- 网关

- 建模语言 GraphQL, 解决复杂系统的数据建模
- JSON-RPC

- 桌面的半栈拿掉后？！？


- 中心化的视图数据服务 (抽象数据库，用 js 查询的数据库? 把 js 打造成 类似 SQL 查询语法？！？)：
  1. 业务脚本沙箱；（vm?!xxxx, 太慢，内存占用高，因为v8垃圾回收机制。所以，造！一！个！ vm）
  2. 自动容灾； 1. 打底； 2. 动态 （阿里的容灾真是面面俱到）
  3. ...
  4. ...
  5. ...
  6. 慢接口支持！！！（这个好，慢慢优化）

### 个人总结
 - 也许是 js 统一数据库查询语言的时候到了。

## 三、【UC】Randy： TypeScript，
示范代码，效果很好，安利不错，希望我司也能用上 TypeScript 写核心业务（不过我司主要问题不是 TypeScript, 而是业务分离没做好，缺少架构）

（示范写代码过程中，长发的主持人帮演讲者两次拿麦，当了两次程序员鼓励师，内心是崩溃的。）

## 四、【腾讯】姚穗斌: Node.js 直出套路（服务器渲染）

### 前言
- 开发理由： 边际成本最小化（造轮子就造轮子呗，不过，还是要给领导解释我们是怎么省钱的。。。）
- web 服务器: IO 是瓶颈

### 小目标
 - 私用协议，如何接入 Node.js，用 Node.js 重写协议吗？不，写一个通用协议包，再去定制协议。
 - 网络协议的优化，用 Node.js 改造当前冗余的 tcp 协议: ** easy_sock **
 - 支持命名空间
 - 使用前端司空见惯的 url 作为协议地址

### 负载均衡
没细说，没关主题。

### bigPipe
- 分段输出（这个有点意思，极致优化，最大改善用户体验）

### 思想
- 从命令式编程到声明式编程 （造轮子的终于找到自己的定位，造出路来）
- 业务不想关心过程 （ How ), 只想告诉程序要做什么 （What）（深藏功与名）
- 。。。
- 。。。

### Q&A
- 自定义的网络协议，客户端（用户端）能用吗？（没，属于后端服务之间的通信）

### 个人总结
 - api 友好，json 配置。
 - 从项目结构截图来看，把前端组件化，搬到后端渲染组件化。
 - 听过两次腾讯分享，都离不开网络协议轮子，页面优化输出。难道在腾讯，网络协议是必知必会？

## 五、辩论：使用同一种语言构建完整系统好还是使用不同语言混合构建系统好
** 正方：单构 **

** 反方：多构 **

(
个人选择单构，考虑处在小团队

同事们个个身怀绝技, ruby, c, c++, R, java。。

我只会 javascript

嗯，站队时，同事们都离我远远的
  )

(站单构的队，实为单构捏一把汗。含着泪也要站完。。。)

正方一辩，热情奔放为 js 颂歌，为单构的情感上，埋下伏笔。。
 > 所有能用 javascript 实现的功能，都会用 javascript 实现。

 > javascript 会一统江湖，此刻我们都是 javascript。

 （反方信念有点动（bian）摇(jie)（后面发力不足可以看出），毕竟大会就是 Node.js， 没有 PHP 和其它语言）

反方开始摆事实，历史原因，各个技术栈多构事实。。。证据凿凿

正方危险。。

正方三辩，及时调整战略，收窄辩论范围，指向系统，分系统内与系统外。指出系统内单构好处，商业价值观等等。指出系统外的历史原因，解决方案。既有理想，又有现实。声情并茂，顿挫抑扬，说得比唱得好听。（高潮，此时掌声响起）
> 历史原因，历史包袱等，可能不用我们解决，它自己就解决自己（死掉的语言一大堆）

自由辩论：混战，反方提出统一思想，才有统一语言的观点。（统一思想也不是什么好观点）理由更难站住脚，正方抓住就反驳。也扯点社会现象（克制不能谈太白）。（港真：说英语又说粤语，混着说不仅，还要跟大陆做生意讲普通话，闹过独立。香港：怪我咯！）正方四辩倒是大方谈香港，底气十足，层层剥开，多构复杂造成，理想为单构。

总结陈词：
反方四辩：讲现实。（有点乏味）
正方四辩：讲理想，讲未来。（煽情）

胜负一目了然。正方三辩获得最佳辩手。
（其实反方是可以讲自由理想的!只是，可能一开始就变节了:(）

（纯粹辩论，不要当真。认真就你就输了）

## 离场：
拍了照，加了微信群，临走时，手快拿了一本 《docker开发》书。

一共收获两本书。电梯时，有一妹子很高兴拿到公仔，我欲想拿两本书换，妹子不愿意。

嗯，周一可以拿书送给新人看。

-----
（现场前排观众一枚，大小脑不断地思考与跟进演讲者的技术思路，情感不断地受巧舌如簧的辨手们撩动。当时只记大纲，回忆是混乱的。如有不实，请联系我更改。）

> 与知乎同步 【参加Node地下铁沙龙第三场广州站是怎样的体验？】 https://www.zhihu.com/question/53269065/answer/134266193
